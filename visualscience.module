<?php

/**
 * @file
 * This module is used to search and visualize users/nodes.
 */

//Tools pre-made by Vahe
require_once 'includes/visualscience.settings.inc';
require_once 'includes/visualscience.utils.inc';

//Classes for each functionality
include('includes/visualscience.searchtable.class.php');
include('includes/visualscience.message.class.php');
include('includes/visualscience.upload.class.php');

//Initialization of the main objects
$search = new Search();
$message = new Message();
$upload = new Upload();


/**
 * Implementation of hook_menu().
 */
function visualscience_menu() {

  $items['visualscience'] = array(
    'title' => 'Visual Science',
    'description' => 'Visual Science description',
    'page callback' => 'visualscience_page',
    'page arguments' => array(true),
    'access callback' => TRUE,
    'weight' => 30,
    );


  $items['visualscience/upload'] = array(
    'title' => 'VisualScience Upload',
    'description' => 'Upload a file in VisualScience',
    'page callback' => 'drupal_get_form',
    'page arguments' => array('visualscience_upload_form'),
    'access arguments' => array('access visualscience'),
    'type' => MENU_CALLBACK,
    );

  $items['visualscience/file'] = array(
    'title' => 'VisualScience Attachment Access',
    'description' => 'Access a file uploaded from VisualScience',
    'page callback' => 'visualscience_get_file_with_id',
    'access callback' => TRUE,
    'type' => MENU_CALLBACK,
    );

  $items['visualscience/mail'] = array(
    'title' => 'VisualScience Mail Send',
    'description' => 'Send Mail from VisualScience',
    'page callback' => 'visualscience_send_message',
    'access arguments' => array('access visualscience'),
    'type' => MENU_CALLBACK,
    );

  return $items;
}

function visualscience_upload_form ($form, &$form_state) {
  return $upload->visualscience_upload_form($form, &$form_state);
} 


/**
 * 
 */	
function visualscience_get_file_with_id () {
	return $upload->visualscience_get_file_with_id();
}

/**
 * 
 */
function visualscience_send_message() {
	return $message->visualscience_send_message();
}


function visualscience_upload_submit($form, &$form_state) {
  return $upload->visualscience_upload_submit($form, &$form_state);	
}

/**
 * 
 * Creates the visualscience page
 */
function visualscience_page($clear = true) {
  $search->getClienteSideFiles();

  //In output, you'll have to put your actual html.
  $output = "asdfasdf";
  return $output;
}

?>
